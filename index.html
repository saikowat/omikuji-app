<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>今日ガチャ</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- CSS: 見た目を整える --- */
        body {
            font-family: "M PLUS Rounded 1c", sans-serif;
            text-align: center;
            background-color: #D1C4E9; /* 現在の背景色 */
            padding-top: 50px;
        }

        #draw-button {
            padding: 15px 30px;
            font-size: 20px;
            font-family: "Noto Sans JP", sans-serif, "M PLUS Rounded 1c";
            background-color: #E1BEE7;
            color: #666666;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            
            transition: all 0.1s; /* 全ての変化を0.1秒で高速に実行 */
            box-shadow: 0 5px 0 #C5AECA; /* ボタンの下に濃い影（奥行き）を作成 */
        }

        #draw-button:hover {
            background-color: #D4B6DB;
        }
        
        /* ボタンをクリックしている間（:active）のスタイルを定義 */
        #draw-button:active {
            transform: translateY(5px); /* 5ピクセル下に移動させる */
            box-shadow: none; /* 影を消すことで沈み込んだように見せる */
        }

        #fortune-image {
            width: 500px; 
            display: none; /* 要素を非表示にする */
            margin: 20px auto;
        }

        #result {
            margin-top: 30px;
            font-size: 30px;
            font-family: "Noto Sans JP", sans-serif, "M PLUS Rounded 1c";
            font-weight: bold;
            color: #333;
            min-height: 60px; /* 結果が何もなくても高さを確保 */
        }

        /* 結果表示エリアと画像にトランジションを設定 */
        #result, #fortune-image {
            transition: opacity 0.5s ease-in-out; /* 透明度の変化を0.5秒かけて滑らかに実行 */
            opacity: 0; /* 初期状態を完全に透明にする */
        }
    </style>
</head>
<body>

    <p id="date-display">--年--月--日 (--)</p>

    <div id="weather-info">
        <img id="weather-icon" src="" alt="天気アイコン" style="vertical-align: middle;">
        <p><span id="description-display">--</span>
        <span id="temp-min-display">--</span> / <span id="temp-max-display">--</span></p>
    </div>

    <button id="draw-button">ガチャを引く</button>
    <img id="fortune-image" src="" alt="ガチャ結果の画像" >
    <p id="result">はてさて</p>

<script>
    /* --- JavaScript: 動作 (ロジック) --- */

    // 1. 運勢のリストを作成
    const fortunes = [
        "01. 待たせるのはギルティ", "02. 5分経ってわからなければ聞く", "03. 段取り8割 早めの行動", "04. ひとりごとアウトプットをしよう",
        "05. 下からすぎない 圧を身に着けよ", "06. Slackに投げて文殊の知恵を借りろ", "07. 自分のくせを理解して操縦せよ",
        "08. 手を付けて見積もってから仕上げ時期を決める", "09. ゴールを見ろ", "10. 煮詰まったらスクワットでも", "11. ゴールをメモって見返そう", 
        "12. 一旦スケジュールを忘れて全力でいけ", "13. 作り終わってから細部を整える", "14. 「自分が何とかしなければ、、」の精神", 
        "15. やっときましょうか？の精神", "16. 何もしないことが最も罪深い 行動を", 
        "17. 許可より謝罪", "18. ポジティブオーラをまとえ", "19. 心に柴犬を抱えて働け", "20. タメ口で行くくらいの精神",
    ];

    // 2. HTML要素を取得
    const drawButton = document.getElementById('draw-button');
    const resultDisplay = document.getElementById('result');

    // 3. おみくじを引く関数を定義 (変更後)
    function drawOmikuji() {
        const maxIndex = fortunes.length;
        const randomIndex = Math.floor(Math.random() * maxIndex);
        const selectedFortune = fortunes[randomIndex];

        // 新しい画像表示要素を取得
        const resultImage = document.getElementById('fortune-image');
        
        // 運勢に応じたファイル名を設定する変数
        let imageName = "";

        // 運勢に応じて表示テキストと画像名を決定
        if (selectedFortune === "01. 待たせるのはギルティ") {
            resultDisplay.style.color = "#696969";
            imageName = "01.png";
        } else if (selectedFortune === "02. 5分経ってわからなければ聞く") {
            resultDisplay.style.color = "#696969";
            imageName = "02.png";
        } else if (selectedFortune === "03. 段取り8割 早めの行動") {
            resultDisplay.style.color = "#696969";
            imageName = "03.png";
        } else if (selectedFortune === "04. ひとりごとアウトプットをしよう") {
            resultDisplay.style.color = "#696969";
            imageName = "04.png";
        } else if (selectedFortune === "05. 下からすぎない 圧を身に着けよ") {
            resultDisplay.style.color = "#696969";
            imageName = "05.png";
        } else if (selectedFortune === "06. Slackに投げて文殊の知恵を借りろ") {
            resultDisplay.style.color = "#696969";
            imageName = "06.png";
        } else if (selectedFortune === "07. 自分のくせを理解して操縦せよ") {
            resultDisplay.style.color = "#696969";
            imageName = "07.png";
        } else if (selectedFortune === "08. 手を付けて見積もってから仕上げ時期を決める") {
            resultDisplay.style.color = "#696969";
            imageName = "08.png";
        } else if (selectedFortune === "09. ゴールを見ろ") {
            resultDisplay.style.color = "#696969";
            imageName = "09.png";
        } else if (selectedFortune === "10. 煮詰まったらスクワットでも") {
            resultDisplay.style.color = "#696969";
            imageName = "10.png";
        } else if (selectedFortune === "11. ゴールをメモって見返そう") {
            resultDisplay.style.color = "#696969";
            imageName = "11.png";
        } else if (selectedFortune === "12. 一旦スケジュールを忘れて全力でいけ") {
            resultDisplay.style.color = "#696969";
            imageName = "12.png";
        } else if (selectedFortune === "13. 作り終わってから細部を整える") {
            resultDisplay.style.color = "#696969";
            imageName = "13.png";
        } else if (selectedFortune === "14. 「自分が何とかしなければ、、」の精神") {
            resultDisplay.style.color = "#696969";
            imageName = "14.png";
        } else if (selectedFortune === "15. やっときましょうか？の精神") {
            resultDisplay.style.color = "#696969";
            imageName = "15.png";
        } else if (selectedFortune === "16. 何もしないことが最も罪深い 行動を") {
            resultDisplay.style.color = "#696969";
            imageName = "16.png";
        } else if (selectedFortune === "17. 許可より謝罪") {
            resultDisplay.style.color = "#696969";
            imageName = "17.png";
        } else if (selectedFortune === "18. ポジティブオーラをまとえ") {
            resultDisplay.style.color = "#696969";
            imageName = "18.png";
        } else if (selectedFortune === "19. 心に柴犬を抱えて働け") {
            resultDisplay.style.color = "#696969";
            imageName = "19.png";
        } else if (selectedFortune === "20. タメ口で行くくらいの精神") {
            resultDisplay.style.color = "#696969";
            imageName = "20.png"
        }
        
        // 結果を表示エリアに書き込む
        resultDisplay.textContent = selectedFortune;

        // 画像要素の src (ソース) を更新して画像を表示
        resultImage.src = "images/" + imageName; 
        // ↑ imagesフォルダに入れた画像を表示するパス

        // 画像を表示する (display: none を解除する)
        resultImage.style.display = "block";

        // 画像と結果の透明度を1に戻し、フェードインさせる
        resultImage.style.opacity = "1";
        resultDisplay.style.opacity = "1";
        
    }

    // --- 4. 天気情報を取得・表示する関数 ---

    const API_KEY = "59236f40aa6bf4dc86d4e2e4429f7a63"; 
    const CITY_ID = "1850147"; // 東京のCity ID

function fetchWeather() {
    // OpenWeatherMapのAPIエンドポイント
    const url = `https://api.openweathermap.org/data/2.5/weather?id=${CITY_ID}&appid=${API_KEY}&units=metric&lang=ja`;
    
    // fetch関数を使ってAPIにリクエストを送信
    fetch(url)
        .then(response => response.json()) // 受け取ったデータをJSON形式に変換
        .then(data => {
            // ★★★ 取得するデータ ★★★
            const tempMin = Math.round(data.main.temp_min); // Math.round()で四捨五入
            const tempMax = Math.round(data.main.temp_max); // Math.round()で四捨五入
            const description = data.weather[0].description;  // 天気の説明
            const iconCode = data.weather[0].icon;            // 天気アイコンコード ("04d"など)

            // ★★★ HTML要素への表示 ★★★
            
            // 1. 最高/最低気温の表示
            const tempMaxDisplay = document.getElementById('temp-max-display');
            tempMaxDisplay.textContent = `${tempMax}°C`; // 四捨五入された値を使用

            const tempMinDisplay = document.getElementById('temp-min-display');
            tempMinDisplay.textContent = `${tempMin}°C`; // 四捨五入された値を使用
            
            // 2. 天気アイコンの表示
            const weatherIcon = document.getElementById('weather-icon');
            // OpenWeatherMapのアイコンURLにコードを組み込んで表示
            weatherIcon.src = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;


            // 3. 天気の表示 
            const descriptionDisplay = document.getElementById('description-display');
            descriptionDisplay.textContent = description;

            console.log("天気データの取得に成功しました:", data);
        })
        .catch(error => {
            console.error("天気データの取得中にエラーが発生しました:", error);
            // エラー時の表示も、全てハイフンに設定
            document.getElementById('temp-max-display').textContent = "--";
            document.getElementById('temp-min-display').textContent = "--";
            document.getElementById('description-display').textContent = "取得失敗";
        });
    }

    // 5. アプリがロードされたらすぐに天気情報を取得する
    fetchWeather(); 
    
    // 6. ボタンに「クリックされたらdrawOmikujiを実行する」という設定を付ける
    drawButton.addEventListener('click', drawOmikuji);

    // 7. 日付と曜日を表示する関数
        function displayDate() {
        // 現在のDateオブジェクトを取得
        const now = new Date();
        
        // 年月日を取得
        const year = now.getFullYear();
        const month = now.getMonth() + 1; // getMonth()は0から始まるため +1 する
        const day = now.getDate();
        
        // 曜日を取得
        const days = ["日", "月", "火", "水", "木", "金", "土"];
        const dayOfWeek = days[now.getDay()]; // getDay()は0(日)から6(土)を返す
        
        // 表示用の文字列を組み立てる
        const dateString = `${year}年${month}月${day}日 (${dayOfWeek})`;
        
        // HTMLに書き出す
        const dateDisplay = document.getElementById('date-display');
        dateDisplay.textContent = dateString;
    }

    // 8. アプリがロードされたらすぐに日付を表示する
    displayDate();

</script>

</body>
</html>
